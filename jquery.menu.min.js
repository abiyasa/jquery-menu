
(function($,window,document,undefined){function createKeyCodeMap(){var map={};for(var charCode=65;charCode<=90;charCode++){map[charCode]=String.fromCharCode(charCode);}
return map;}
$.fn.menu=function menu(){return this.each(function onEach(){var $this=$(this);var $button=$this.find('button');var $rootMenu=$this.find('> [role=menu], > *:last-child > [role=menu]').first();var $groups=$rootMenu.find('> div[role=presentation]');var $allmenuitems=$rootMenu.find('> [role^=menuitem], > div > [role^=menuitem], > a');var $links=$rootMenu.find('a');var $buttons=$rootMenu.find('[role=menuitem]');var $checkboxes=$rootMenu.find('[role=menuitemcheckbox]');var $radios=$rootMenu.find('[role=menuitemradio]');var $firstMenuItem=$allmenuitems.first();var $subMenus=$rootMenu.find('[role=menuitem][aria-haspopup=true]');var keyCodeMap=createKeyCodeMap();var shortcutKeyMap={};$allmenuitems.each(function(idx){shortcutKeyMap[$(this).text()[0]]=idx;});$this.nextId('popupmenu');$this.buttonFlyout({focusManagement:true});$this.commonKeyDown('[role^=menuitem]');$rootMenu.rovingTabindex($allmenuitems,{axis:'y'});$rootMenu.prop('id',$this.prop('id')+'-menu');$button.attr('aria-haspopup','true').prop('id',$this.prop('id')+'-button');$subMenus.attr('aria-expanded','false');$allmenuitems.not('a').on('click spaceKeyDown enterKeyDown',function(e){$this.trigger('menuSelect');});$checkboxes.on('click spaceKeyDown enterKeyDown',function(e){$(this).attr('aria-checked',$(this).attr('aria-checked')==='true'?'false':'true');});$radios.on('click spaceKeyDown enterKeyDown',function(e){$radios.attr('aria-checked','false');$(this).attr('aria-checked','true');});$this.on('buttonFlyoutOpen buttonFlyoutClose',function onShowOrHide(){$allmenuitems.attr('tabindex','-1');});$allmenuitems.on('keydown',function(e){var char=keyCodeMap[e.keyCode];var itemIndex=shortcutKeyMap[char];if(itemIndex){$allmenuitems.get(itemIndex).focus();}});$this.on('menuSelect',function onMenuSelect(e){$button.focus();});$this.preventScrollKeys('[role^=menuitem]');$this.addClass('menu--js');});};}(jQuery));